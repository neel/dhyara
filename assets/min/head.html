<head>
	<title>Dhyara Ad Hoc Network</title>
	<link rel="icon" href="data:,">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
	<meta content="utf-8" http-equiv="encoding">
	<link rel="stylesheet" href="/dhyara.css"/>
	<script>let d=document,q=e=>d.querySelectorAll(e),create=(e,t,...a)=>{let n=d.createElement(e);if("object"==typeof t)for(let[e,a]of Object.entries(t))n.setAttribute(e,a);return a.forEach(e=>n.append(e)),n};d.addEventListener("DOMContentLoaded",function(){q("#menu li").forEach(e=>e.append(create("a",{href:e.dataset.href},e.dataset.label))),q(".cell").forEach(e=>e.prepend(create("span",{class:"key"},e.dataset.key)))});let fetch_banner=()=>fetch("/info.json").then(e=>e.json()).then(function(e){let t=(e,t)=>q('#info-iface .cell[data-key="'+e+'"]')[0].append(t);t("ssid",e.ap.ssid),t("mac",e.ap.address),t("channel",e.ap.channel+"("+e.ap.bandwidth+"Mhz)"),t("frequency",e.ap.frequency.begin+"-"+e.ap.frequency.end+"Mhz)"),t("power saving",e.power.saving),t("max power",e.power.max),t("authentication",e.ap.authentication),t("max clients",e.ap.max_connections)}).catch(e=>setTimeout(fetch_banner,500)),fetch_dhyara=()=>fetch("/info.json").then(e=>e.json()).then(function(e){let t=(e,t)=>q('#info-dhyara .cell[data-key="'+e+'"]')[0].append(t);t("send queueing",e.dhyara.send_queueing),t("queue size",e.dhyara.queue_size),t("sync queue size",e.dhyara.sync_queue_size),t("broadcast channel",e.dhyara.espnow_broadcast_channel),t("peer channel",e.dhyara.espnow_peer_channel),t("beacon interval",e.dhyara.beacon_interval+"ms"),t("delay tolerance",e.dhyara.delay_tolerance+"ms"),t("depreciation coefficient",e.dhyara.depreciation_coefficient),t("advertisement expiry",e.dhyara.advertisement_expiry+"ms"),t("route expiry",e.dhyara.route_expiry+"ms")}).catch(e=>setTimeout(fetch_dhyara,500)),poll_counters=()=>fetch("/counter.json").then(e=>e.json()).then(function(e){let t=(e,t)=>q('#counter .cell[data-key="'+e+'"] .value')[0].innerHTML=" &#8593; "+t.tx+" &#8595; "+t.rx;t("beacon",e.beacon),t("acknowledgement",e.acknowledgement),t("advertisement",e.advertisement),t("chunk",e.chunk),t("delivered",e.delivered),t("echo request",e.echo_request),t("echo reply",e.echo_reply),t("echo lost",e.echo_lost),setTimeout(poll_counters,500)}).catch(e=>setTimeout(poll_counters,200)),poll_routing=()=>fetch("/routes.json").then(e=>e.json()).then(function(e){let t=q("#routes-body")[0],a=q("#next-body")[0];t.innerHTML="",a.innerHTML="",e.routes.map(e=>create("tr",{},create("td",{},e.dst),create("td",{},e.via),create("td",{},e.delay+"ms"),create("td",{},e.updated))).forEach(e=>t.append(e)),e.next.map(e=>create("tr",{},create("td",{},e.dst),create("td",{},e.via),create("td",{},e.delay+"ms"))).forEach(e=>a.append(e)),setTimeout(poll_routing,2e3)}).catch(e=>setTimeout(poll_routing,200)),poll_peers=()=>fetch("/peers.json").then(e=>e.json()).then(function(e){let t=q("#neighbours-body")[0],a=q("#universe-body")[0];t.innerHTML="",a.innerHTML="",e.neighbours.map(e=>create("tr",{},create("td",{},e.mac),create("td",{},e.name),create("td",{},e.channel),create("td",{},e.rssi))).forEach(e=>t.append(e)),e.universe.map(e=>create("tr",{},create("td",{},e.mac),create("td",{},e.name))).forEach(e=>a.append(e)),setTimeout(poll_peers,2e3)}).catch(e=>setTimeout(poll_peers,200));</script>
</head>
